Batch Size:  64
Preparing corpus...
(24724,) (24724,)
Dataset Device: cuda
Batch Size:  64
Preparing corpus...
(1106,) (1106,)
Dataset Device: cuda
Batch Size:  64
Dataset Device: cuda
0.95
0.95
0.95
0.95
0.95
0.855
0.855
0.855
0.855
0.855
0.8
0.8
0.8
0.8
0.8
0.8
0.8
0.8
0.8
0.8
-- Starting training with scheduler.
### Epoch     0 
Pred: TETNEN TONE TONE THE TENHNENENN TETER  TORNLE  OOTH THN TERIIN N TN  REN E TTORNLE  OOTH TN TOMMANHE   TH THE N TONTT TN TNTORN OT THENE  N TN TEMAT TE    TOMMA THE TOENT TERN  TANN TERIOD , True: REAGAN WILL GIVE THE NICARAGUAN REBELS DOUBLE-QUOTE HIS PERSONAL ASSURANCES DOUBLE-QUOTE OF COMMITMENT TO THEIR CAUSE AT A MEETING THURSDAY IN LOS ANGELES COMMA THE WHITE HOUSE SAID PERIOD
Pred: THIDS TESSN AAPHEN TESE  TART L  RTH  ANI TEOMEES TS NG E PUOTE TOARANAL TS CG E PUOTE TOOM TN  TETE AN THNE  RN TON E TORR THE  THE SOMMANI TENENTINICS TN E TFHER TETINES  OETERIOD, True: SAINT LOUIS HYPHEN BASED MONSANTO COMPANY DROPPED 'SINGLE-QUOTE CHEMICAL 'SINGLE-QUOTE FROM ITS NAME IN NINETEEN SIXTY FOUR WHEN THE COMPANY DIVERSIFIED INTO OTHER BUSINESSES PERIOD
Epoch: 0	Batch: 100	Avg-Loss: 248.1099	Avg-Perplexity: 11.6674	Avg-Distance: 143.2927 
Pred: TORPATI TTEODERS OS AN TIRLLDD AMMA DANTIIT SE    AOMMA DRR  ANSONA AUNDRED TILLARSANDAYG TH SONTY TIVE PF TNS AF  AUNDRED THONTY TIVE PIRK RS AOR TIR TEANENG AF THE SUNSAXEINS O AERIOD, True: CUMMINGS PROPERTIES IN WOBURN COMMA MASSACHUSETTS COMMA PAYS A FIVE HUNDRED DOLLAR REWARD TO FIFTY FIVE OF ITS ONE HUNDRED TWENTY FIVE WORKERS FOR NOT SMOKING ON THE JOB ELLIPSIS PERIOD
Pred: DUORIAIC N CESONPANAAARE  AF THE SORLTARS S SAEEET TE IR TRINSD THEEE PIGHT   TH CHONTY SND SINE PNGHT   TF THO PUNDRED SIXTYEN PHEUSAND DOMMA DORR PUNDRED SIARE  AERIOD, True: SPECIFICALLY COMMA SHARES OF THE CALIFORNIA THRIFT SFFED GAINED THREE EIGHTHS TO TWENTY AND FIVE EIGHTHS ON TWO HUNDRED SIXTEEN THOUSAND COMMA FOUR HUNDRED SHARES PERIOD
Epoch: 0	Batch: 200	Avg-Loss: 172.0108	Avg-Perplexity: 5.3153	Avg-Distance: 110.3083 
Pred: TH EO S AHE CANDRED THONTY TIVE PEOCK AONEE SSS UX TELE TF TTANDRED THONTY THO POINT TNE PEXTPH THO HHPTEVEN PHE REND CHNTPINDRED TIVENTY TEX PEINT TNE PORR AAOOOORTAAOOOOOOOOOOOOO, True: TOKYO'S TWO HUNDRED TWENTY FIVE STOCK NIKKEI INDEX ROSE ONE HUNDRED TWENTY TWO POINT ONE SIX TO TWENTY SEVEN THOUSAND SIX HUNDRED SEVENTY SIX POINT ONE FOUR
Pred: TU M. TOMND BEECD TN TH THN AELLION DOLLARS OF T S. S. ARNE VER COMMA TR. BERENR CAIS TOMMA TU TONANCIAG TNSWALH TNTAOAG TF TEAT OND TLUITY TERIOD, True: B. P. COULD SPEND UP TO TEN BILLION DOLLARS ON A U. S. TAKEOVER COMMA MR. LAZIER SAYS COMMA BY FINANCING IT WITH A BLEND OF DEBT AND EQUITY PERIOD
Epoch: 0	Batch: 300	Avg-Loss: 150.4473	Avg-Perplexity: 4.3045	Avg-Distance: 101.8316 
Pred: DN THE SARKET CTRRLLITED TOMMA T SRCANRIEER TOMMA T SHAEIEUNSTYPHEN SADLIW TNDOERSITY TXONOMICTSTOMMA THESK  THE CESAGESOH TOMTUMER IAECDING THIL TE SETIT D TERIOD, True: IF THE MARKET STABILIZES COMMA ALAN MELTZER COMMA A CARNEGIE HYPHEN MELLON UNIVERSITY ECONOMIST COMMA THINKS THE DAMAGE TO CONSUMER SPENDING WILL BE LIMITED PERIOD
## Start validating....
Pred: THE SAME MATERIALS THE SHAPE AND SHIPPING POINT FOUR PERCENT IN THE SECURITIES AND SHEEP OR BY TRADING COMMA AND THE SAME MATERIALS THE SHAPE AND SHIPPING POINT FOUR PERCENT IN THE SECURITIES AND SHEEP OR BY TRADING COMMA AND THE SAME MATERIALS THE SHAPE AND SHIPPING POINT FOUR PERCENT IN THE SECURITIES AND SHEEP OR BY TRADING COMMA AND THE SAME MATERIALS THE SHAPE AND SHIPPING POINT FOUR PERCENT IN THE SECURITIES AND SHEEP OR BY TRADING COMMA AND THE SAME MATERIALS THE SHAPE AND SHIPPING POINT , True: DOUBLE-QUOTE WE SAW IT WITH OIL AND WE'RE SEEING IT WITH GOLD COMMA DOUBLE-QUOTE SAYS JOHN DESSAUER COMMA AN ORLEANS COMMA MASSACHUSETTS COMMA MONEY MANAGER PERIOD
Pred: THE SAME MATERIALS THE SHAPE AND SHIPPING POINT FOUR PERCENT IN THE SECURITIES AND SHEEP OR BY TRADING COMMA AND THE SAME MATERIALS THE SHAPE AND SHIPPING POINT FOUR PERCENT IN THE SECURITIES AND SHEEP OR BY TRADING COMMA AND THE SAME MATERIALS THE SHAPE AND SHIPPING POINT FOUR PERCENT IN THE SECURITIES AND SHEEP OR BY TRADING COMMA AND THE SAME MATERIALS THE SHAPE AND SHIPPING POINT FOUR PERCENT IN THE SECURITIES AND SHEEP OR BY TRADING COMMA AND THE SAME MATERIALS THE SHAPE AND SHIPPING POINT , True: ACER INTERNATIONAL CORPORATION OF TAIWAN SHOWS A MACHINE BILLED AS COMPATIBLE WITH THE BOTTOM HYPHEN OF HYPHEN THE HYPHEN LINE P. S. SLASH TWO MODEL THIRTY PERIOD
Pred: THE SAME MATERIALS THE SHAPE AND SHIPPING POINT FOUR PERCENT IN THE SECURITIES AND SHEEP OR BY TRADING COMMA AND THE SAME MATERIALS THE SHAPE AND SHIPPING POINT FOUR PERCENT IN THE SECURITIES AND SHEEP OR BY TRADING COMMA AND THE SAME MATERIALS THE SHAPE AND SHIPPING POINT FOUR PERCENT IN THE SECURITIES AND SHEEP OR BY TRADING COMMA AND THE SAME MATERIALS THE SHAPE AND SHIPPING POINT FOUR PERCENT IN THE SECURITIES AND SHEEP OR BY TRADING COMMA AND THE SAME MATERIALS THE SHAPE AND SHIPPING POINT , True: PAYOFFS TO MOSCOW BY THE WEST COULD RANGE FROM SOFTENING HUMAN HYPHEN RIGHTS POLICIES TO EXTENDING CHEAP LOANS TO RELAXING TECHNOLOGY CONTROLS PERIOD
Pred: THE SAME MATERIALS THE SHAPE AND SHIPPING POINT FOUR PERCENT IN THE SECURITIES AND SHEEP OR BY TRADING COMMA AND THE SAME MATERIALS THE SHAPE AND SHIPPING POINT FOUR PERCENT IN THE SECURITIES AND SHEEP OR BY TRADING COMMA AND THE SAME MATERIALS THE SHAPE AND SHIPPING POINT FOUR PERCENT IN THE SECURITIES AND SHEEP OR BY TRADING COMMA AND THE SAME MATERIALS THE SHAPE AND SHIPPING POINT FOUR PERCENT IN THE SECURITIES AND SHEEP OR BY TRADING COMMA AND THE SAME MATERIALS THE SHAPE AND SHIPPING POINT , True: AFTER THE BUY HYPHEN OUT IS COMPLETED COMMA HE SAID COMMA PLAYTEX APPAREL WILL HAVE TOTAL DEBT OF ABOUT THREE HUNDRED FIFTY MILLION DOLLARS PERIOD
Pred: THE SAME MATERIALS THE SHAPE AND SHIPPING POINT FOUR PERCENT IN THE SECURITIES AND SHEEP OR BY TRADING COMMA AND THE SAME MATERIALS THE SHAPE AND SHIPPING POINT FOUR PERCENT IN THE SECURITIES AND SHEEP OR BY TRADING COMMA AND THE SAME MATERIALS THE SHAPE AND SHIPPING POINT FOUR PERCENT IN THE SECURITIES AND SHEEP OR BY TRADING COMMA AND THE SAME MATERIALS THE SHAPE AND SHIPPING POINT FOUR PERCENT IN THE SECURITIES AND SHEEP OR BY TRADING COMMA AND THE SAME MATERIALS THE SHAPE AND SHIPPING POINT , True: IN ADDITION COMMA BATUS IS EXPECTED THIS MORNING TO FILE FOR APPROVAL OF A TAKEOVER WITH INSURANCE REGULATORS IN NINE WESTERN STATES WHERE FARMERS OPERATES PERIOD
Pred: THE SAME MATERIALS THE SHAPE AND SHIPPING POINT FOUR PERCENT IN THE SECURITIES AND SHEEP OR BY TRADING COMMA AND THE SAME MATERIALS THE SHAPE AND SHIPPING POINT FOUR PERCENT IN THE SECURITIES AND SHEEP OR BY TRADING COMMA AND THE SAME MATERIALS THE SHAPE AND SHIPPING POINT FOUR PERCENT IN THE SECURITIES AND SHEEP OR BY TRADING COMMA AND THE SAME MATERIALS THE SHAPE AND SHIPPING POINT FOUR PERCENT IN THE SECURITIES AND SHEEP OR BY TRADING COMMA AND THE SAME MATERIALS THE SHAPE AND SHIPPING POINT , True: DOUBLE-QUOTE BUT COMMA DOUBLE-QUOTE HE EXPLAINS COMMA DOUBLE-QUOTE WE DECIDED THAT THE ADS CONTAIN THE MESSAGE WE WANT TO GET OUT ABOUT THE COMPANY'S QUALITY CONCERNS PERIOD
Pred: THE SAME MATERIALS THE SHAPE AND SHIPPING POINT FOUR PERCENT IN THE SECURITIES AND SHEEP OR BY TRADING COMMA AND THE SAME MATERIALS THE SHAPE AND SHIPPING POINT FOUR PERCENT IN THE SECURITIES AND SHEEP OR BY TRADING COMMA AND THE SAME MATERIALS THE SHAPE AND SHIPPING POINT FOUR PERCENT IN THE SECURITIES AND SHEEP OR BY TRADING COMMA AND THE SAME MATERIALS THE SHAPE AND SHIPPING POINT FOUR PERCENT IN THE SECURITIES AND SHEEP OR BY TRADING COMMA AND THE SAME MATERIALS THE SHAPE AND SHIPPING POINT , True: DOUBLE-QUOTE LET'S JUST SAY COMMA IT'S NOT A ROARING SUCCESS COMMA DOUBLE-QUOTE SAID ONE WEST COAST FRANCHISEE OF THE DOUBLE-QUOTE WE DO IT LIKE YOU'D DO IT DOUBLE-QUOTE PROMOTIONAL THEME PERIOD
## Start validating....
Train Loss: 602.0610	Train Distance: 403.7227	Train Perplexity: 323.3478	Val Loss: 570.8545	Val Distance: 391.9339	Val Perplexity: 320.9774 
Epoch time used:  4555.3408489227295 s 
### Epoch     1 
Traceback (most recent call last):
  File "Baseline_Run_1.py", line 237, in <module>
    output_path=output_path)
  File "/home/ubuntu/deep_learning/utterance2text_attention_LAS/trainer_with_tensorboar_inference.py", line 60, in run
    (data_batch, label_batch), TEACHER_FORCING_Ratio, TEST=False, NUM_CONFIG=NUM_CONFIG, SEARCH_MODE=TRAIN_SEARCH_MODE)  # N, max_label_L, vocab_size; N, max_label_L
  File "/home/ubuntu/anaconda3/envs/pytorch_p36/lib/python3.6/site-packages/torch/nn/modules/module.py", line 489, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/ubuntu/deep_learning/utterance2text_attention_LAS/s2s_controller.py", line 74, in forward
    y_hat, y_hat_labels, labels_padded, labels_lens, attentions = self.decoder(argument_list)
  File "/home/ubuntu/anaconda3/envs/pytorch_p36/lib/python3.6/site-packages/torch/nn/modules/module.py", line 489, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/ubuntu/deep_learning/utterance2text_attention_LAS/s2s_speller_Baseline.py", line 123, in forward
    return self.forward_greedy_search(argument_list[:-2])
  File "/home/ubuntu/deep_learning/utterance2text_attention_LAS/s2s_speller_Baseline.py", line 193, in forward_greedy_search
    rnn_input, (self.hidden_states[0], self.memory_states[0])
  File "/home/ubuntu/anaconda3/envs/pytorch_p36/lib/python3.6/site-packages/torch/nn/modules/module.py", line 489, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/ubuntu/anaconda3/envs/pytorch_p36/lib/python3.6/site-packages/torch/nn/modules/rnn.py", line 727, in forward
    self.check_forward_hidden(input, hx[0], '[0]')
  File "/home/ubuntu/anaconda3/envs/pytorch_p36/lib/python3.6/site-packages/torch/nn/modules/rnn.py", line 572, in check_forward_hidden
    input.size(0), hidden_label, hx.size(0)))
RuntimeError: Input batch size 64 doesn't match hidden[0] batch size 18
